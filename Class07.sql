--------- CLASS 07
DROP DATABASE Round61
GO
CREATE DATABASE Round61
GO
USE Round61
GO
--CRUD
--CREATE 
CREATE TABLE Employee
(
Id INT,
Name VARCHAR(30),
Salary FLOAT,
MobileNo VARCHAR(30)
)
GO
--INSERT
INSERT INTO Employee
VALUES
(1,'Rina',1000,'01518317509'),
(2,'Bina',2000,'01518317508'),
(3,'Tina',3000,'01518317507'),
(4,'Mina',4000,'01518317506'),
(5,'Runa',5000,'01518317505')
GO

--READ
SELECT * FROM Employee
GO

CREATE TABLE Candidate
(
Id INT,
Name VARCHAR(30)
)
GO
INSERT INTO Candidate
VALUES
(50,'Tusar'),
(51,'Samrat')
GO

SELECT * FROM Employee
SELECT * FROM Candidate
GO
--MARGE
MERGE Employee AS TERGET
USING Candidate  AS SOURCE 
ON SOURCE.Id=TERGET.Id
WHEN NOT MATCHED THEN
INSERT(Id,Name)
VALUES(SOURCE.Id,SOURCE.Name);
GO
--DELETE
MERGE Employee AS TARGET
USING Candidate AS SOURCE 
ON SOURCE.Id=TARGET.Id
WHEN NOT MATCHED BY SOURCE THEN
DELETE;

INSERT INTO Candidate
VALUES
(60,'Samaul'),
(61,'Rabbi')
GO
--UPDATE 
UPDATE Employee
SET Salary=6000
WHERE Id=60
GO
--UPDATE 
UPDATE Employee
SET MobileNo='012457845'
WHERE Id=60
GO
--DELETE
DELETE FROM Employee
WHERE Id=61
GO


